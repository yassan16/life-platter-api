# エラーレスポンス仕様

プロジェクト全体で使用するエラー時のレスポンス型を定義します。

---

## エラーレスポンス型

| フィールド | 型 | 必須 | 説明 |
|-----------|------|:----:|------|
| `error_code` | string | ○ | アプリ固有の識別子。フロントエンドがswitch文などで分岐処理するために使用 |
| `message` | string | ○ | ユーザーに表示できる説明文。ログやデバッグにも有用 |
| `details` | array \| null | ○ | 補足情報。バリデーションエラー時のフィールド別エラーや、デバッグ用の追加データを格納。不要な場合は`null` |

---

## レスポンス例

### バリデーションエラー（details配列あり）

```json
{
  "error_code": "VALIDATION_ERROR",
  "message": "入力内容に誤りがあります",
  "details": [
    {"field": "email", "reason": "無効な形式です"},
    {"field": "age", "reason": "0以上の値が必要です"}
  ]
}
```

### リソース不存在（details: null）

```json
{
  "error_code": "USER_NOT_FOUND",
  "message": "指定されたユーザーは存在しません",
  "details": null
}
```

---

## error_code 一覧（例）

| error_code | 説明 | HTTPステータス |
|------------|------|:-------------:|
| `VALIDATION_ERROR` | 入力値のバリデーションエラー | 400 |
| `USER_NOT_FOUND` | ユーザーが存在しない | 404 |
| `INVALID_TOKEN` | トークンが無効または期限切れ | 401 |
| `PERMISSION_DENIED` | 権限がない | 403 |
| `INTERNAL_ERROR` | サーバー内部エラー | 500 |

> Note: HTTPステータスコードはレスポンスヘッダーで返却されます。

---

## 設計理由

この型で十分な理由:

- **HTTPステータスコード**: 別途レスポンスヘッダーで返るため、bodyに含める必要がない
- **3層構造**:
  - `error_code` → 機械的な判定（フロントエンドの分岐処理）
  - `message` → 人間向けの説明
  - `details` → 詳細情報（必要に応じて拡張可能）

シンプルかつ拡張性のある構造です。
