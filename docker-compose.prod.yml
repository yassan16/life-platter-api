# 本番環境（EC2）用設定
# 使用方法: docker compose -f docker-compose.yml -f docker-compose.prod.yml up -d
services:
  db:
    restart: always
    env_file:
      - .env.production

  nginx:
    restart: always

  app:
    restart: always
    env_file:
      - .env.production
    command: ["uvicorn", "app.main:app", "--host", "0.0.0.0", "--port", "8000", "--workers", "4"]
    # ソースコードのマウントは行わない（ビルド時にコピー済み）
